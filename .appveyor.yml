version: 1.0.{build}
image: Visual Studio 2015
#init:
#  - git config --global core.autocrlf input
clone_folder: c:\projects\TestCI
shallow_clone: true           
matrix:
   fast_finish: false
platform:
    - x64
    - x86
configuration:
    - Debug
    - Release
environment:
#    matrix:
#       - TOOLCHAIN: msvc12
 priv_key:
    secure: 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
#install:
#  - ps: $fileContent = "-----BEGIN RSA PRIVATE KEY-----`n"
#  - ps: $fileContent += $env:priv_key.Replace(' ', "`n")
#  - ps: $fileContent += "`n-----END RSA PRIVATE KEY-----`n"
#  - ps: Set-Content $env:userprofile\.ssh\id_rsa $fileContent
#  - git submodule update --init --recursive

#before_build:
# - git clone https://github.com/unloguc/Test_CI-private-.git
#- mkdir test
# - cd test
# - cmake .. %CMAKE_CONFIGURE_FLAGS%
# - cmake --build . %CMAKE_BUILD_FLAGS%
 - cd C:\projects\TestCI
 - mkdir clones
 - git clone https://github.com/unloguc/TestCI.git
build_script:
  - cd C:\projects\TestCI
  - mkdir build
  - cd build
  - cmake .. %CMAKE_CONFIGURE_FLAGS%
  - cmake --build . %CMAKE_BUILD_FLAGS%
#  - cd bin
# - '**\*.test_TestCI.exe'
test_script:
 - cmd: C:\projects\TestCI\build\bin\test_TestCI.exe